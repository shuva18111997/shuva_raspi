#define ADC_In A0

//Y(n) = Y(n - 1) + Î£(h(k) * X(n - k))
//Y(n) = Y(n - 1) + X(n)*h(0) + X(n-1)*h(1)
//Y(0) = Y(0 - 1) + (X(0)*h(0) + X(0-1)*h(1)) X(Not Possible)
//Y(1) = Y(0) + (X(1)*h(0) + X(0)*h(1))
//Y(2) = Y(1) + (X(2)*h(0) + X(1)*h(1))
//Y(3) = Y(2) + (X(3)*h(0) + X(2)*h(1))
//. . . . .
//Y(N) = Y(N - 1) + (X(N)*h(0) + X(N - 1)*h(1))

float h[] = {0.002704535589515786, 0.0028510022990185027, 0.003245982612883977, 0.003889144612142876, 0.004775656589807408, 0.005896216240995074, 0.007237164667068334, 0.008780683830275707, 0.01050507443168858, 0.012385109570220279, 0.014392458007605764, 0.01649616944530503, 0.018663212944062896, 0.02085905851216948, 0.0230482909777643, 0.025195244563339655, 0.027264646112110533, 0.029222254686636306, 0.03103548527560111, 0.03267400460553548, 0.03411028755597521, 0.035320123409598024, 0.036283062118948745, 0.036982791919643494, 0.03740744094349103, 0.03754979695719298, 0.03740744094349102, 0.03698279191964349, 0.036283062118948745, 0.03532012340959802, 0.034110287555975206, 0.03267400460553548, 0.03103548527560111, 0.029222254686636296, 0.02726464611211052, 0.025195244563339648, 0.023048290977764292, 0.02085905851216947, 0.018663212944062885, 0.01649616944530502, 0.014392458007605764, 0.012385109570220279, 0.010505074431688573, 0.008780683830275696, 0.007237164667068324, 0.005896216240995066, 0.004775656589807408, 0.0038891446121428743, 0.003245982612883976, 0.0028510022990185005, 0.002704535589515786};
#define len sizeof(h) / sizeof(float)
float Xn[len];

void setup() {
  Serial.begin(115200);
  for(int i = 0; i < len; i++)
  {
    Xn[i] = 0;
  }
}

void loop() {
  int analog_input = analogRead(ADC_In);
  Serial.print(analog_input);
  Serial.print("\t");
  Serial.println(filter(analog_input));
}

float filter(int data)
{
  float Yn = 0;
  for(int i = 0; i < (len - 1); i++)
  {
    Xn[(len - 1) - i] = Xn[(len - 2) - i];
  }
  Xn[0] = data;
  for(int i = 0; i < len; i++)
  {
    Yn += Xn[i] * h[i];
  }
  return Yn;
}
